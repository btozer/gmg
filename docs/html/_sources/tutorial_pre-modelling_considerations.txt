.. _pre-modelling_considerations:

========================================================
**2.0 Pre-modelling data processing and considerations**
========================================================

As we are interested in modelling the structure of the Weardale granite, important preprocessing steps 
prior to forward modelling the gravity and magnetic anomalies is to consider other factors contributing to 
the total field anomalies.

One common preprocessing step when working with potential field data for near-surface structure modeling is to separate the 
"regional" component of the anomaly from the overall anomaly. This separation helps eliminate the contribution from the 
longer wavelength regional signal, which can originate from the juxtaposition of different basement terranes, for instance. 
These regional anomalies, resulting from deep sources, possess much longer wavelengths compared to the anomalies associated 
with our target structure, which resides in the upper crust.

By performing this separation, we can focus specifically on the anomalies produced by our target structure, 
which will aid in generating a more accurate model.

===================================================
*2.1 Gravity anomaly: regional/residual separation*
===================================================

There are several different strategies for calculating regional anomalies. For the gravity data we will use the regional gravity field 
as determined by :cite:`Kimbell2011` as shown in :numref:`regional_gravity_map`. As can be seen in this figure, there is a long
wavelength positive anomaly in this region with amplitudes ranging :math:`\sim` :math:`14-21` :math:`mGal`.

We will simply subtract this long wavelength component from the total anomaly, to produce the residual Bouguer anomaly as shown 
in :numref:`residual_gravity_map`. We will model this residual signal to estimate the subsurface structure of the Weardale granite.

.. figure:: _static/regional_anomaly.png
    :scale: 50%
    :name: regional_gravity_map

    Regional gravity anomaly related to long wavelength density anomalies (as published by :cite:`Kimbell2011`).
    Note, the regional felid is positive, whereas the Waredale granite is expected to produce a negative 
    anomaly relative to the surrounding basement rock.  

.. figure:: _static/residual_bouguer_anomaly.png
    :scale: 50%
    :name: residual_gravity_map

    Residual gravity anomaly derived by subtracting the regional anomaly from the total. This reflects the 
    anomaly caused upper crustal features (i.e., the Weardale granite). Note, the central low, related to the
    granite, now has a larger amplitude. 

=============================================
*2.2 Magnetic anomaly: Reduction To the Pole*
=============================================

In order to model the magnetic anomaly, we'll apply a Reduction To the 
Pole (RTP) operation on the grid. We do this to simplify the interpretation of the anomaly as 
the resulting anomaly appears as if it were observed at the geomagnetic pole, such that, 
the subsurface bodies are magnetized vertically. This removes the skewness introduced to the observed anomaly as observation 
latitude increases. Here, we assume the magnetic sources share the same inclination and declination as the Earth field.

.. note::

    Processing of the magnetic anomaly data was conducted using the python implementation of the Generic Mapping Tools 
    `PyGMT <https://www.pygmt.org/latest/index.html>`_. For those interested readers, the Jupyter Notebook containing the 
    processing recipe can be found in the docs/ directory.  

.. figure:: _static/rtp_magnetic_anomaly.png
    :scale: 50%
    :name: magnetic_map_rtp

    Reduced To Pole magnetic anomaly. The reduction is calculated using the 1964 (when the survey was acquired) 
    inclination and declination of :math:`9.1` degrees, and a magnetic declination of :math:`68.6` degrees.

==================================
*2.3 Regional/Residual Separation*
==================================

Similarly to the gravity grid, we will also perform a regional-residual seperation to extract a 
long wavelength regional field. We then remove regional field from the total field to produce a 
residual anomaly that reflects near surface sources. 

To produce the regional grid we will apply a 2000 m upward continuation operation on the anomaly to 
transfer the observation elevation from 305 m (the aeromagnetic survey flight height) to 2305 m. 
This attenuates short wavelengths signals (generated by relatively shallower sources), with the 
longer wavelength regional field remaining.

.. figure:: _static/rtp_regional_magnetic_anomaly.png
    :scale: 50%
    :name: regional_magnetic_map

    Regional magnetic anomaly derived by upward continuing the observed anomaly to 2700 m.

.. figure:: _static/rtp_residual_magnetic_anomaly.png
    :scale: 50%
    :name: residual_magnetic_map

    Residual RTP anomaly derived by subtracting the regional anomaly from the Reduced 
    To Pole anomaly. Note, this grid reveals many linear anomalies, related to fault traces, 
    mineral veins, dykes and sills (:cite:`Kimbell2011`). 